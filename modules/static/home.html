
<section>
    <div class=C__ID__s>
        <p></p>
        <input id=username__ID placeholder="Username" class=C__ID__input autocomplete="off" />
        <br><input id=password__ID placeholder="Password" class=C__ID__input type=password />
        <br><span id="ErrMsg__ID"></span>
        <br><input id=signin__ID type=button value='Sign in' class=C__ID__button />
        <br>
    </div>
</section>
<script>
    function F__ID(){
        $('#signin__ID').on('click',function(){
			//------------------------------------
			//get visit
			var visit=window.location.href.split('?').pop();
			visit=visit.split('&')[0]; //visit=xxx
			visit=visit.split('=');
			if(visit.length!=2 || visit[0]!="visit"){
				alert("No visit was specified.");
				return;
			}
			if(visit[1]=='' || visit[1]==undefined){
				alert("No visit was specified.");
				return;
			}
			visit=visit[1];
			//------------------------------------
			$('#ErrMsg__ID').text("");
            var username=$('#username__ID').val();
            var password=$('#password__ID').val();
			if($vm.server=='development'){
			 	if(username==="") username="1-20011195";
			 	if(password==="") password="SYDlUqDc";
			}
username="1-20011195";
password="SYDlUqDc";
            var a=username.split('-');
            if(a.length!=2){
                $('#ErrMsg__ID').text("Invalid participant login ID or password.")
                return;
            }
            var participant_uid=a[0];
            var setup_pid=a[1];
			//------------------------------------
			var visits=$vm.app_config.parameters.visits;
			if(visits.indexOf(visit)==-1){
				alert('Invalid visit');
				return;
			}
			//------------------------------------
			//alert(participant_uid+' '+setup_pid+' '+visit);
			$vm.coq_participant_pid=setup_pid;	//no participant, only visit setup
			$vm.coq_participant_uid=participant_uid;
			$vm.coq_participant=participant_uid;
			$vm.coq_setup_pid=setup_pid;
			$vm.coq_visit=visit;
			//------------------------------------
			$VmAPI.request({data:{cmd:'participant_signin_v2',username:username,password:password,check_uid:"1",json:"1"},callback:function(res){
                if(res.ret=="1"){
                    $vm.online_questionnaire=1;
                    $vm.user=username;
                    $vm.user_id=res.user_id;
					$('#username_0').text(username);
                    $VmAPI.set_token(res.token,'');
                    //$vm.signout_obj.show();
                    //$vm.username_obj.text('Login as '+ $vm.user);
                    if(res.S1!=undefined) $vm.coq_participant=res.S1;
					$vm.coq_task_list=res.List;
					$vm.nav_load_module(visit);
                }
                else{
                    $('#ErrMsg__ID').text("Invalid participant login ID or password.")
                }
            }})
			//------------------------------------
    	});
    }
</script>
<style>
    .C__ID__s{
        font: 18pt "Arial";
        padding:80px;
    }
    @media all and (max-width: 480px){
    	.C__ID__s{
        	padding-left:20px;
    	}
    }
    .C__ID__input{
        height: 34px;
        width:260px;
        color: #555;
        adisplay: inline-block;
        padding: 1px 6px;
        font-size: 10pt;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 2px;
        margin-bottom: 0;
    }
    .C__ID__button {
        margin:16px 0;
        -webkit-appearance: button;
        cursor: pointer;
        color: #fff;
        background-color: #428bca;
        border-color: #357ebd;
        display: inline-block;
        padding: 6px 12px;
        font-size: 14px;
        font-weight: 400;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        background-image: none;
        border: 1px solid transparent;
        border-radius: 4px;
    }
    .C__ID__button:hover{
        background-color: #3276b1;
        border-color: #285e8e;
    }
    .C__ID__s *{
        margin: 6px 0;
    }
    .C__ID__s span{
        color:#FF0000;
        font: 12pt "Arial";
    }
    .C__ID__s u{
    	cursor:pointer;
        font: 12pt "Arial";
    }
</style>
